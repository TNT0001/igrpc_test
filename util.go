package main

import (
	"crypto/tls"
	"crypto/x509"
	"encoding/json"
	"fmt"
	"git.ghtk.vn/gmicro/ig/igrpc-proto/generated/igdata-service"
	"google.golang.org/grpc/credentials"
	"log"
	"math/rand"
	"os"
)

var (
	serverCAPEM = []byte("-----BEGIN CERTIFICATE-----\nMIIGLDCCBRSgAwIBAgIMVrv93PaefkVJo9brMA0GCSqGSIb3DQEBCwUAMEwxCzAJ\nBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWduIG52LXNhMSIwIAYDVQQDExlB\nbHBoYVNTTCBDQSAtIFNIQTI1NiAtIEcyMB4XDTIxMDQxMzA2NDEwMFoXDTIyMDUx\nNTA2NDEwMFowFDESMBAGA1UEAwwJKi5naHRrLnZuMIIBIjANBgkqhkiG9w0BAQEF\nAAOCAQ8AMIIBCgKCAQEAtE/kDtHkzwNSMqQke4VG/90XT4hnxj/6xbWqF+CE77II\np3jit6pBePAx6MdjAgy2NwCd/uNINrLd3CpYo4zqdlnTlzuZLDt1rMC02d3tQJpN\neZs716JEcLl54UGNirSIMfMkYiLtN6ybev0OSZFassKiNcgQOPcY0sxCxZi7Rms/\nnkrliiGfhH/h3F4w99Hw0gV1094fT7k2iQqJ17EWmi74stg+isi/32mpUSxmHbA3\nGRTeLTXe3NfiDRcOwGHCIFr7JHaQFXDeL0sON0SyVjZjZCaq0wuSiQ0Y/w1ZtcJS\nmOF2pIJAAi35Pnv5TGwna5X7XhaoGCDumSYNJ10ZCQIDAQABo4IDRDCCA0AwDgYD\nVR0PAQH/BAQDAgWgMIGJBggrBgEFBQcBAQR9MHswQgYIKwYBBQUHMAKGNmh0dHA6\nLy9zZWN1cmUyLmFscGhhc3NsLmNvbS9jYWNlcnQvZ3NhbHBoYXNoYTJnMnIxLmNy\ndDA1BggrBgEFBQcwAYYpaHR0cDovL29jc3AyLmdsb2JhbHNpZ24uY29tL2dzYWxw\naGFzaGEyZzIwVwYDVR0gBFAwTjBCBgorBgEEAaAyAQoKMDQwMgYIKwYBBQUHAgEW\nJmh0dHBzOi8vd3d3Lmdsb2JhbHNpZ24uY29tL3JlcG9zaXRvcnkvMAgGBmeBDAEC\nATAJBgNVHRMEAjAAMD4GA1UdHwQ3MDUwM6AxoC+GLWh0dHA6Ly9jcmwyLmFscGhh\nc3NsLmNvbS9ncy9nc2FscGhhc2hhMmcyLmNybDAdBgNVHREEFjAUggkqLmdodGsu\ndm6CB2dodGsudm4wHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMB8GA1Ud\nIwQYMBaAFPXN1TwIUPlqTzq3l9pWg+Zp0mj3MB0GA1UdDgQWBBR++tYld/vAr4jn\nbtWu7vW9jgpKfDCCAX4GCisGAQQB1nkCBAIEggFuBIIBagFoAHcAb1N2rDHwMRnY\nmQCkURX/dxUcEdkCwQApBo2yCJo32RMAAAF4yfY78QAABAMASDBGAiEAqOkxLC+R\nBmlC5C/DmMRG2XuboYArd5sczNNKeykyaVgCIQDGaqHvFr7u/VRnt6g4iIY1u18Y\nm2gHL5WeSzFmYpPYigB1ACl5vvCeOTkh8FZzn2Old+W+V32cYAr4+U1dJlwlXceE\nAAABeMn2Pv4AAAQDAEYwRAIgHSU6no6bRGHSLqz3XL0+caOZvzpLgSuseLqbH8jJ\norsCIAz8fRlQxdeGgFni2PlB/gPZ1yaEUKk21VRhkvEH7Cw7AHYAVYHUwhaQNgFK\n6gubVzxT8MDkOHhwJQgXL6OqHQcT0wwAAAF4yfY8GgAABAMARzBFAiEAxVOhXEaB\nuoK+vl3v03JvC66luemhOStWhBT3a+N2wesCICcO3dr08Be68B9rNdSfK8f6xgBs\nosndyICCcNpkJOg+MA0GCSqGSIb3DQEBCwUAA4IBAQBcCULWw7Kz22DcgX1KDALi\nog8exF67kJywnNHTnuBgDkS61t0rKwrkUwoA3jmP0GKDfnsBryLT59Zie/hbkqXY\nkEUZn1RRvqb8FtO6DDyb0s+3sJxIsrCYiOEaOvvTHkv9qitzZ2DnrSblfbzeKjFj\nHbIDX4NJfFt3Z06NicV7oFJBUGr68Cn5OvlUh5BybLhJsr2oXa9ofka+PnzJo7cu\nPo1/zIMnXWX7UA7GEvh8f0YSAfOPJ6QGcStZ6r5r4NKWwCxh2KbGvdgCXhKQXQ6Y\nIlxo0VlHY4NdE8uXPtq/5O95FbUH4WsTFfc5vZcQsi8P2ywLN9w4hrou87ctxnQx\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIETTCCAzWgAwIBAgILBAAAAAABRE7wNjEwDQYJKoZIhvcNAQELBQAwVzELMAkG\nA1UEBhMCQkUxGTAXBgNVBAoTEEdsb2JhbFNpZ24gbnYtc2ExEDAOBgNVBAsTB1Jv\nb3QgQ0ExGzAZBgNVBAMTEkdsb2JhbFNpZ24gUm9vdCBDQTAeFw0xNDAyMjAxMDAw\nMDBaFw0yNDAyMjAxMDAwMDBaMEwxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9i\nYWxTaWduIG52LXNhMSIwIAYDVQQDExlBbHBoYVNTTCBDQSAtIFNIQTI1NiAtIEcy\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA2gHs5OxzYPt+j2q3xhfj\nkmQy1KwA2aIPue3ua4qGypJn2XTXXUcCPI9A1p5tFM3D2ik5pw8FCmiiZhoexLKL\ndljlq10dj0CzOYvvHoN9ItDjqQAu7FPPYhmFRChMwCfLew7sEGQAEKQFzKByvkFs\nMVtI5LHsuSPrVU3QfWJKpbSlpFmFxSWRpv6mCZ8GEG2PgQxkQF5zAJrgLmWYVBAA\ncJjI4e00X9icxw3A1iNZRfz+VXqG7pRgIvGu0eZVRvaZxRsIdF+ssGSEj4k4HKGn\nkCFPAm694GFn1PhChw8K98kEbSqpL+9Cpd/do1PbmB6B+Zpye1reTz5/olig4het\nZwIDAQABo4IBIzCCAR8wDgYDVR0PAQH/BAQDAgEGMBIGA1UdEwEB/wQIMAYBAf8C\nAQAwHQYDVR0OBBYEFPXN1TwIUPlqTzq3l9pWg+Zp0mj3MEUGA1UdIAQ+MDwwOgYE\nVR0gADAyMDAGCCsGAQUFBwIBFiRodHRwczovL3d3dy5hbHBoYXNzbC5jb20vcmVw\nb3NpdG9yeS8wMwYDVR0fBCwwKjAooCagJIYiaHR0cDovL2NybC5nbG9iYWxzaWdu\nLm5ldC9yb290LmNybDA9BggrBgEFBQcBAQQxMC8wLQYIKwYBBQUHMAGGIWh0dHA6\nLy9vY3NwLmdsb2JhbHNpZ24uY29tL3Jvb3RyMTAfBgNVHSMEGDAWgBRge2YaRQ2X\nyolQL30EzTSo//z9SzANBgkqhkiG9w0BAQsFAAOCAQEAYEBoFkfnFo3bXKFWKsv0\nXJuwHqJL9csCP/gLofKnQtS3TOvjZoDzJUN4LhsXVgdSGMvRqOzm+3M+pGKMgLTS\nxRJzo9P6Aji+Yz2EuJnB8br3n8NA0VgYU8Fi3a8YQn80TsVD1XGwMADH45CuP1eG\nl87qDBKOInDjZqdUfy4oy9RU0LMeYmcI+Sfhy+NmuCQbiWqJRGXy2UzSWByMTsCV\nodTvZy84IOgu/5ZR8LrYPZJwR2UcnnNytGAMXOLRc3bgr07i5TelRS+KIz6HxzDm\nMTh89N1SyvNTBCVXVmaU6Avu5gMUTu79bZRknl7OedSyps9AsUSoPocZXun4IRZZ\nUw==\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIDdTCCAl2gAwIBAgILBAAAAAABFUtaw5QwDQYJKoZIhvcNAQEFBQAwVzELMAkG\nA1UEBhMCQkUxGTAXBgNVBAoTEEdsb2JhbFNpZ24gbnYtc2ExEDAOBgNVBAsTB1Jv\nb3QgQ0ExGzAZBgNVBAMTEkdsb2JhbFNpZ24gUm9vdCBDQTAeFw05ODA5MDExMjAw\nMDBaFw0yODAxMjgxMjAwMDBaMFcxCzAJBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9i\nYWxTaWduIG52LXNhMRAwDgYDVQQLEwdSb290IENBMRswGQYDVQQDExJHbG9iYWxT\naWduIFJvb3QgQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDaDuaZ\njc6j40+Kfvvxi4Mla+pIH/EqsLmVEQS98GPR4mdmzxzdzxtIK+6NiY6arymAZavp\nxy0Sy6scTHAHoT0KMM0VjU/43dSMUBUc71DuxC73/OlS8pF94G3VNTCOXkNz8kHp\n1Wrjsok6Vjk4bwY8iGlbKk3Fp1S4bInMm/k8yuX9ifUSPJJ4ltbcdG6TRGHRjcdG\nsnUOhugZitVtbNV4FpWi6cgKOOvyJBNPc1STE4U6G7weNLWLBYy5d4ux2x8gkasJ\nU26Qzns3dLlwR5EiUWMWea6xrkEmCMgZK9FGqkjWZCrXgzT/LCrBbBlDSgeF59N8\n9iFo7+ryUp9/k5DPAgMBAAGjQjBAMA4GA1UdDwEB/wQEAwIBBjAPBgNVHRMBAf8E\nBTADAQH/MB0GA1UdDgQWBBRge2YaRQ2XyolQL30EzTSo//z9SzANBgkqhkiG9w0B\nAQUFAAOCAQEA1nPnfE920I2/7LqivjTFKDK1fPxsnCwrvQmeU79rXqoRSLblCKOz\nyj1hTdNGCbM+w6DjY1Ub8rrvrTnhQ7k4o+YviiY776BQVvnGCv04zcQLcFGUl5gE\n38NflNUVyRRBnMRddWQVDf9VMOyGj/8N7yy5Y0b2qvzfvGn9LhJIZJrglfCm7ymP\nAbEVtQwdpf5pLGkkeB6zpxxxYu7KyJesF12KwvhHhm4qxFYxldBniYUr+WymXUad\nDKqC5JlR3XC321Y9YeRq4VzW9v493kHMB65jUr9TU/Qr6cf9tveCX4XSQRjbgbME\nHMUfpIBvFSDJ3gyICh3WZlXi/EjJKSZp4A==\n-----END CERTIFICATE-----\n")
	localCertPEMTung = []byte("-----BEGIN CERTIFICATE-----\nMIIFHzCCAwegAwIBAgIUG0NpL8v2J5PEEeWBltdAfNAzwPwwDQYJKoZIhvcNAQEL\nBQAwFDESMBAGA1UEAwwJbG9jYWxob3N0MB4XDTIxMDgwMzA1NDIzN1oXDTIyMDgw\nMzA1NDIzN1owFDESMBAGA1UEAwwJbG9jYWxob3N0MIICIjANBgkqhkiG9w0BAQEF\nAAOCAg8AMIICCgKCAgEA1V+e++aO0popPMqd937QaGRRlwgB+C6SlnTiQY+gGY+E\nU16ToywgNj4s6fg6VKhhia2urUEPwX91KlKweiJ+PdDJBNKe0oufhmLrs7cO4OZp\nQr9Z6XZeh39zNjYDsWK1Tp6T8zJ4E+nfqffjRiAJ9rszr1waT6ElAf9QIHSrGaZN\nDVaCM95jgN/nVx46exVqDcIjuWAXIFkO6NVBaC+ev76DqNC/raZpkxbUGnFP7PGV\nrVbEILVmw4s2czcv9hVHhtOZWb7eXv0VFMy8FoF8HiLjW+eGwWqI0r2yJ6YPRbsk\nHrW4cviZ7cLV5nOdfMyWfCIGa8Pj2+eOuDFANf2PRkzUf0itIp6kG9CCVviC917b\nBGHKpYofwLe5BXI7+Qqx+M0IuDouiRE6TOrQxZFiPXA+miIWUXd+0g2YKhXRb6V/\njbPm7VPNPqpOqePZ97PySRMQDIjtg4HhpK20hXV090uFX/+KDhW0Mnxd6eDpQilM\nJvUmzakyuUNvNUP3ep7/I+/EZd9bUuNmZUR3bjrOqlyW46RfgtuyODhoiZ5gQYI/\niWrU4IPMftyXM5FRqHKdJFmAD8YrxAt7HmO8rJZ4Bk42HgYX3yQpmKOAFGMuD7kv\nRRwCon8bUjMR7KiIjJkAwtBqmO4OEFlz7zn/jgi15TB0BGWFAtdhgVRyu4waYlsC\nAwEAAaNpMGcwHQYDVR0OBBYEFHIh9FI3Cn8Pu4bDup6pmTmKadRzMB8GA1UdIwQY\nMBaAFHIh9FI3Cn8Pu4bDup6pmTmKadRzMA8GA1UdEwEB/wQFMAMBAf8wFAYDVR0R\nBA0wC4IJbG9jYWxob3N0MA0GCSqGSIb3DQEBCwUAA4ICAQCk7zi5ZtG80NozZnT6\n2b1lkseryKJ3yMbhGE+saexSahbhg9r6He1pyl61MCU0vFhVGJoLDX11nEkF+QNW\nNTFpGvp+rOWix2SP8lo3Lb8gUU5A84lPZUvPYyaq1LGTsMuO+HydqpzLPHX+nUKl\nPdvc9COeJDkTkKBTFUvi0Skd+iaQ43Sfpjz4lvujG2TPQlHHkmKY2DX8QAHg18yJ\nUJ0iNp7tmc1OFqPLQw6K9J7TNsw06Oa2akrgaKatFCEwDcO5JF5iJ18GwIUlpWxv\njcTbDqRKbcF4s3c/1m992TVgZATNHddt8nRIr1bTMR8e9fLRfk/DfsQFpkhCGsDe\nW5Q9XokDNBAp/ZBEE3zW2Zpb3yVC9Js7iYrs4QZo5pR3HR7skgL0HlHxvpTmlLC/\n30kImNMv8onK3TjI42TyrH6qXqvQSiJgodJ7WrvpeDNeu20swm/tanHh4ysMVaUd\ngjG9e/lyoNEcyqstyRMvgnotBAcdp3ZIndX1N+wxWkrVHVWJmPenKDHAPTm7dsqR\nZfUDh+mSo89BpZOXM+uRsbGBf/t6KGM4fOM0apnJ6/p7ym2v4JCjatirXXMeP7YH\nIqZlcUeZrLnJYjP6NFDBRuxYDc2HRNBsTSRdxV9CL9A8+PAKfJxvSakPYEU9t3Oi\nBPBd+1MJVBKJURtEIpZD499bug==\n-----END CERTIFICATE-----\n")
	clientCertTung = []byte("-----BEGIN CERTIFICATE-----\nMIIHUTCCBjmgAwIBAgIRAMaIHCiHVglqTX+rpXNiKvowDQYJKoZIhvcNAQELBQAw\ngZUxCzAJBgNVBAYTAkdCMRswGQYDVQQIExJHcmVhdGVyIE1hbmNoZXN0ZXIxEDAO\nBgNVBAcTB1NhbGZvcmQxGDAWBgNVBAoTD1NlY3RpZ28gTGltaXRlZDE9MDsGA1UE\nAxM0U2VjdGlnbyBSU0EgT3JnYW5pemF0aW9uIFZhbGlkYXRpb24gU2VjdXJlIFNl\ncnZlciBDQTAeFw0yMDAyMTAwMDAwMDBaFw0yMjAyMDkyMzU5NTlaMIHNMQswCQYD\nVQQGEwJWTjEPMA0GA1UEERMGMTAwMDAwMQ8wDQYDVQQIEwZIYSBOb2kxFDASBgNV\nBAcTC05hbSBUdSBMaWVtMSowKAYDVQQJEyFWVFYgQnVpZGluZyxObyA4IFBoYW4g\nSHVuZyBzdHJlZXQxMDAuBgNVBAoTJ0dpYW8gSGFuZyBUaWV0IEtpZW0gSm9pbnQg\nU3RvY2sgQ29tcGFueTEQMA4GA1UECxMHTWFuYWdlcjEWMBQGA1UEAwwNKi5naHRr\nbGFiLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALy+Ir0C2W9P\nYJk17iNUHfMoe/6kB9qRM33uhbTz5sdg7TxrUaKcyqtKnmt5ZRRpac0fMrOBM+rZ\nYj5Aj428M0icGRj62YIDqszWyrIMG+A5Zd/ASKsMLPL1+oYJ4aExdst5PJCPMIQr\nKrbvqIJmteBZKBkE7Kt/1sIlj5DCvTesJU4mPLhCC1Hud4Di2VqJiFEqzknaMlLT\nj/A5b0DbcEORuGgsEsi3z+TwwPI+x20Y33swHq0+eK5OmvfKW1iFYyl3Lst35QlZ\nxDUoQ9iQWfHi6p0ONLi+ADxBsz8b0XQktPe2/tOqLnvUMydeCV7X4QkmKQPv0qzm\ns3f15QGem1UCAwEAAaOCA2AwggNcMB8GA1UdIwQYMBaAFBfZ1iUnZ/kxwklD2TA2\nRIxsqU/rMB0GA1UdDgQWBBRhr4zUrbh2NQMbJPc7RWocyDpGjjAOBgNVHQ8BAf8E\nBAMCBaAwDAYDVR0TAQH/BAIwADAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUH\nAwIwSgYDVR0gBEMwQTA1BgwrBgEEAbIxAQIBAwQwJTAjBggrBgEFBQcCARYXaHR0\ncHM6Ly9zZWN0aWdvLmNvbS9DUFMwCAYGZ4EMAQICMFoGA1UdHwRTMFEwT6BNoEuG\nSWh0dHA6Ly9jcmwuc2VjdGlnby5jb20vU2VjdGlnb1JTQU9yZ2FuaXphdGlvblZh\nbGlkYXRpb25TZWN1cmVTZXJ2ZXJDQS5jcmwwgYoGCCsGAQUFBwEBBH4wfDBVBggr\nBgEFBQcwAoZJaHR0cDovL2NydC5zZWN0aWdvLmNvbS9TZWN0aWdvUlNBT3JnYW5p\nemF0aW9uVmFsaWRhdGlvblNlY3VyZVNlcnZlckNBLmNydDAjBggrBgEFBQcwAYYX\naHR0cDovL29jc3Auc2VjdGlnby5jb20wJQYDVR0RBB4wHIINKi5naHRrbGFiLmNv\nbYILZ2h0a2xhYi5jb20wggF/BgorBgEEAdZ5AgQCBIIBbwSCAWsBaQB2AEalVet1\n+pEgMLWiiWn0830RLEF0vv1JuIWr8vxw/m1HAAABcC0/BYYAAAQDAEcwRQIgRiqM\nwP4eXUgIYIN9jN/POHIEVy4tkhtZgJ1msIL+mq0CIQCftF9rxhZIbGmWbqOjFL6s\ntSuVUIdF7MrxE9AVweirSgB3AN+lXqtogk8fbK3uuF9OPlrqzaISpGpejjsSwCBE\nXCpzAAABcC0/BZ8AAAQDAEgwRgIhALYXyUTDWcYZDKrxyWcwNuW6rbZuNyVuVae+\nz3oLZGI/AiEA1i7DYghVdgzlg1ULg7TjDE+kjz+JBGYPL7CdbmmboWwAdgBByMqx\n3yJGShDGoToJQodeTjGLGwPr60vHaPCQYpYG9gAAAXAtPwWJAAAEAwBHMEUCIQCa\n03dNi/eot3Ru5BXsDk6hCB9oyIUi+75AoOg5BYsFrgIgPNIsq+QH4nmPA4BPSxgU\nVpB64eJ1a6xdxjIQN14D0m8wDQYJKoZIhvcNAQELBQADggEBAHncIAC+Vp0ZnrEu\nRQHIxTQKjhN+Lf+uv8WRN/8+dFb4mr9f4s3UJ4ZziQ/TC6vj41b20TgPu7NDuXKz\nlw0aNlrEeXVXmzlDkY3LjQpZ7uRpLDe1RLpFZXpnilmGOvVYYdeWbNKm7mZwU++F\nIF6TYwLwgVVvVadK8hW5df3MRn4kW5iIyNCafFvLMhS2KdgCZqnoDNCq0Jr7nlTG\n8NlFZZvwYhKVQf/6kdI9jAd1yhnQG5E7KKxiLt/dciucP9aMvN9dwHaldv24yCkq\nyVfW5IkKILFGKlhBqK0dvRJ084nANCBdpLCV+8rHL0kyeX+B8Wdu8lm0t4lG/jBN\nYhtHa0I=\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIGGTCCBAGgAwIBAgIQE31TnKp8MamkM3AZaIR6jTANBgkqhkiG9w0BAQwFADCB\niDELMAkGA1UEBhMCVVMxEzARBgNVBAgTCk5ldyBKZXJzZXkxFDASBgNVBAcTC0pl\ncnNleSBDaXR5MR4wHAYDVQQKExVUaGUgVVNFUlRSVVNUIE5ldHdvcmsxLjAsBgNV\nBAMTJVVTRVJUcnVzdCBSU0EgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkwHhcNMTgx\nMTAyMDAwMDAwWhcNMzAxMjMxMjM1OTU5WjCBlTELMAkGA1UEBhMCR0IxGzAZBgNV\nBAgTEkdyZWF0ZXIgTWFuY2hlc3RlcjEQMA4GA1UEBxMHU2FsZm9yZDEYMBYGA1UE\nChMPU2VjdGlnbyBMaW1pdGVkMT0wOwYDVQQDEzRTZWN0aWdvIFJTQSBPcmdhbml6\nYXRpb24gVmFsaWRhdGlvbiBTZWN1cmUgU2VydmVyIENBMIIBIjANBgkqhkiG9w0B\nAQEFAAOCAQ8AMIIBCgKCAQEAnJMCRkVKUkiS/FeN+S3qU76zLNXYqKXsW2kDwB0Q\n9lkz3v4HSKjojHpnSvH1jcM3ZtAykffEnQRgxLVK4oOLp64m1F06XvjRFnG7ir1x\non3IzqJgJLBSoDpFUd54k2xiYPHkVpy3O/c8Vdjf1XoxfDV/ElFw4Sy+BKzL+k/h\nfGVqwECn2XylY4QZ4ffK76q06Fha2ZnjJt+OErK43DOyNtoUHZZYQkBuCyKFHFEi\nrsTIBkVtkuZntxkj5Ng2a4XQf8dS48+wdQHgibSov4o2TqPgbOuEQc6lL0giE5dQ\nYkUeCaXMn2xXcEAG2yDoG9bzk4unMp63RBUJ16/9fAEc2wIDAQABo4IBbjCCAWow\nHwYDVR0jBBgwFoAUU3m/WqorSs9UgOHYm8Cd8rIDZsswHQYDVR0OBBYEFBfZ1iUn\nZ/kxwklD2TA2RIxsqU/rMA4GA1UdDwEB/wQEAwIBhjASBgNVHRMBAf8ECDAGAQH/\nAgEAMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjAbBgNVHSAEFDASMAYG\nBFUdIAAwCAYGZ4EMAQICMFAGA1UdHwRJMEcwRaBDoEGGP2h0dHA6Ly9jcmwudXNl\ncnRydXN0LmNvbS9VU0VSVHJ1c3RSU0FDZXJ0aWZpY2F0aW9uQXV0aG9yaXR5LmNy\nbDB2BggrBgEFBQcBAQRqMGgwPwYIKwYBBQUHMAKGM2h0dHA6Ly9jcnQudXNlcnRy\ndXN0LmNvbS9VU0VSVHJ1c3RSU0FBZGRUcnVzdENBLmNydDAlBggrBgEFBQcwAYYZ\naHR0cDovL29jc3AudXNlcnRydXN0LmNvbTANBgkqhkiG9w0BAQwFAAOCAgEAThNA\nlsnD5m5bwOO69Bfhrgkfyb/LDCUW8nNTs3Yat6tIBtbNAHwgRUNFbBZaGxNh10m6\npAKkrOjOzi3JKnSj3N6uq9BoNviRrzwB93fVC8+Xq+uH5xWo+jBaYXEgscBDxLmP\nbYox6xU2JPti1Qucj+lmveZhUZeTth2HvbC1bP6mESkGYTQxMD0gJ3NR0N6Fg9N3\nOSBGltqnxloWJ4Wyz04PToxcvr44APhL+XJ71PJ616IphdAEutNCLFGIUi7RPSRn\nR+xVzBv0yjTqJsHe3cQhifa6ezIejpZehEU4z4CqN2mLYBd0FUiRnG3wTqN3yhsc\nSPr5z0noX0+FCuKPkBurcEya67emP7SsXaRfz+bYipaQ908mgWB2XQ8kd5GzKjGf\nFlqyXYwcKapInI5v03hAcNt37N3j0VcFcC3mSZiIBYRiBXBWdoY5TtMibx3+bfEO\ns2LEPMvAhblhHrrhFYBZlAyuBbuMf1a+HNJav5fyakywxnB2sJCNwQs2uRHY1ihc\n6k/+JLcYCpsM0MF8XPtpvcyiTcaQvKZN8rG61ppnW5YCUtCC+cQKXA0o4D/I+pWV\nidWkvklsQLI+qGu41SWyxP7x09fn1txDAXYw+zuLXfdKiXyaNb78yvBXAfCNP6CH\nMntHWpdLgtJmwsQt6j8k9Kf5qLnjatkYYaA7jBU=\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIFgTCCBGmgAwIBAgIQOXJEOvkit1HX02wQ3TE1lTANBgkqhkiG9w0BAQwFADB7\nMQswCQYDVQQGEwJHQjEbMBkGA1UECAwSR3JlYXRlciBNYW5jaGVzdGVyMRAwDgYD\nVQQHDAdTYWxmb3JkMRowGAYDVQQKDBFDb21vZG8gQ0EgTGltaXRlZDEhMB8GA1UE\nAwwYQUFBIENlcnRpZmljYXRlIFNlcnZpY2VzMB4XDTE5MDMxMjAwMDAwMFoXDTI4\nMTIzMTIzNTk1OVowgYgxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpOZXcgSmVyc2V5\nMRQwEgYDVQQHEwtKZXJzZXkgQ2l0eTEeMBwGA1UEChMVVGhlIFVTRVJUUlVTVCBO\nZXR3b3JrMS4wLAYDVQQDEyVVU0VSVHJ1c3QgUlNBIENlcnRpZmljYXRpb24gQXV0\naG9yaXR5MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAgBJlFzYOw9sI\ns9CsVw127c0n00ytUINh4qogTQktZAnczomfzD2p7PbPwdzx07HWezcoEStH2jnG\nvDoZtF+mvX2do2NCtnbyqTsrkfjib9DsFiCQCT7i6HTJGLSR1GJk23+jBvGIGGqQ\nIjy8/hPwhxR79uQfjtTkUcYRZ0YIUcuGFFQ/vDP+fmyc/xadGL1RjjWmp2bIcmfb\nIWax1Jt4A8BQOujM8Ny8nkz+rwWWNR9XWrf/zvk9tyy29lTdyOcSOk2uTIq3XJq0\ntyA9yn8iNK5+O2hmAUTnAU5GU5szYPeUvlM3kHND8zLDU+/bqv50TmnHa4xgk97E\nxwzf4TKuzJM7UXiVZ4vuPVb+DNBpDxsP8yUmazNt925H+nND5X4OpWaxKXwyhGNV\nicQNwZNUMBkTrNN9N6frXTpsNVzbQdcS2qlJC9/YgIoJk2KOtWbPJYjNhLixP6Q5\nD9kCnusSTJV882sFqV4Wg8y4Z+LoE53MW4LTTLPtW//e5XOsIzstAL81VXQJSdhJ\nWBp/kjbmUZIO8yZ9HE0XvMnsQybQv0FfQKlERPSZ51eHnlAfV1SoPv10Yy+xUGUJ\n5lhCLkMaTLTwJUdZ+gQek9QmRkpQgbLevni3/GcV4clXhB4PY9bpYrrWX1Uu6lzG\nKAgEJTm4Diup8kyXHAc/DVL17e8vgg8CAwEAAaOB8jCB7zAfBgNVHSMEGDAWgBSg\nEQojPpbxB+zirynvgqV/0DCktDAdBgNVHQ4EFgQUU3m/WqorSs9UgOHYm8Cd8rID\nZsswDgYDVR0PAQH/BAQDAgGGMA8GA1UdEwEB/wQFMAMBAf8wEQYDVR0gBAowCDAG\nBgRVHSAAMEMGA1UdHwQ8MDowOKA2oDSGMmh0dHA6Ly9jcmwuY29tb2RvY2EuY29t\nL0FBQUNlcnRpZmljYXRlU2VydmljZXMuY3JsMDQGCCsGAQUFBwEBBCgwJjAkBggr\nBgEFBQcwAYYYaHR0cDovL29jc3AuY29tb2RvY2EuY29tMA0GCSqGSIb3DQEBDAUA\nA4IBAQAYh1HcdCE9nIrgJ7cz0C7M7PDmy14R3iJvm3WOnnL+5Nb+qh+cli3vA0p+\nrvSNb3I8QzvAP+u431yqqcau8vzY7qN7Q/aGNnwU4M309z/+3ri0ivCRlv79Q2R+\n/czSAaF9ffgZGclCKxO/WIu6pKJmBHaIkU4MiRTOok3JMrO66BQavHHxW/BBC5gA\nCiIDEOUMsfnNkjcZ7Tvx5Dq2+UUTJnWvu6rvP3t3O9LEApE9GQDTF1w52z97GA1F\nzZOFli9d31kWTz9RvdVFGD/tSo7oBmF0Ixa1DVBzJ0RHfxBdiSprhTEUxOipakyA\nvGp4z7h/jnZymQyd/teRCBaho1+V\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIEMjCCAxqgAwIBAgIBATANBgkqhkiG9w0BAQUFADB7MQswCQYDVQQGEwJHQjEb\nMBkGA1UECAwSR3JlYXRlciBNYW5jaGVzdGVyMRAwDgYDVQQHDAdTYWxmb3JkMRow\nGAYDVQQKDBFDb21vZG8gQ0EgTGltaXRlZDEhMB8GA1UEAwwYQUFBIENlcnRpZmlj\nYXRlIFNlcnZpY2VzMB4XDTA0MDEwMTAwMDAwMFoXDTI4MTIzMTIzNTk1OVowezEL\nMAkGA1UEBhMCR0IxGzAZBgNVBAgMEkdyZWF0ZXIgTWFuY2hlc3RlcjEQMA4GA1UE\nBwwHU2FsZm9yZDEaMBgGA1UECgwRQ29tb2RvIENBIExpbWl0ZWQxITAfBgNVBAMM\nGEFBQSBDZXJ0aWZpY2F0ZSBTZXJ2aWNlczCCASIwDQYJKoZIhvcNAQEBBQADggEP\nADCCAQoCggEBAL5AnfRu4ep2hxxNRUSOvkbIgwadwSr+GB+O5AL686tdUIoWMQua\nBtDFcCLNSS1UY8y2bmhGC1Pqy0wkwLxyTurxFa70VJoSCsN6sjNg4tqJVfMiWPPe\n3M/vg4aijJRPn2jymJBGhCfHdr/jzDUsi14HZGWCwEiwqJH5YZ92IFCokcdmtet4\nYgNW8IoaE+oxox6gmf049vYnMlhvB/VruPsUK6+3qszWY19zjNoFmag4qMsXeDZR\nrOme9Hg6jc8P2ULimAyrL58OAd7vn5lJ8S3frHRNG5i1R8XlKdH5kBjHYpy+g8cm\nez6KJcfA3Z3mNWgQIJ2P2N7Sw4ScDV7oL8kCAwEAAaOBwDCBvTAdBgNVHQ4EFgQU\noBEKIz6W8Qfs4q8p74Klf9AwpLQwDgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQF\nMAMBAf8wewYDVR0fBHQwcjA4oDagNIYyaHR0cDovL2NybC5jb21vZG9jYS5jb20v\nQUFBQ2VydGlmaWNhdGVTZXJ2aWNlcy5jcmwwNqA0oDKGMGh0dHA6Ly9jcmwuY29t\nb2RvLm5ldC9BQUFDZXJ0aWZpY2F0ZVNlcnZpY2VzLmNybDANBgkqhkiG9w0BAQUF\nAAOCAQEACFb8AvCb6P+k+tZ7xkSAzk/ExfYAWMymtrwUSWgEdujm7l3sAg9g1o1Q\nGE8mTgHj5rCl7r+8dFRBv/38ErjHT1r0iWAFf2C3BUrz9vHCv8S5dIa2LX1rzNLz\nRt0vxuBqw8M0Ayx9lt1awg6nCpnBBYurDC/zXDrPbDdVCYfeU0BsWO/8tqtlbgT2\nG9w84FoVxp7Z8VlIMCFlA2zs6SFz7JsDoeA3raAVGI/6ugLOpyypEBMs1OUIJqsi\nl2D4kF501KKaU73yqWjgom7C12yxow+ev+to51byrvLjKzg6CYG1a4XXvi3tPxq3\nsmPi9WIsgtRqAEFQ8TmDn5XpNpaYbg==\n-----END CERTIFICATE-----")
	clientKeyTung = []byte("-----BEGIN RSA PRIVATE KEY-----\nMIIEpQIBAAKCAQEAvL4ivQLZb09gmTXuI1Qd8yh7/qQH2pEzfe6FtPPmx2DtPGtR\nopzKq0qea3llFGlpzR8ys4Ez6tliPkCPjbwzSJwZGPrZggOqzNbKsgwb4Dll38BI\nqwws8vX6hgnhoTF2y3k8kI8whCsqtu+ogma14FkoGQTsq3/WwiWPkMK9N6wlTiY8\nuEILUe53gOLZWomIUSrOSdoyUtOP8DlvQNtwQ5G4aCwSyLfP5PDA8j7HbRjfezAe\nrT54rk6a98pbWIVjKXcuy3flCVnENShD2JBZ8eLqnQ40uL4APEGzPxvRdCS097b+\n06oue9QzJ14JXtfhCSYpA+/SrOazd/XlAZ6bVQIDAQABAoIBAHvHpjiW+cpKIGva\nNobsz4d8cXUaVhw9Rau9FesKWbtAEdWh/DPM6A1WLncFcgjk6QIhB7s5bLcEQa3Z\n4UtutaNU3BDJ0oO1q/oSk3QZBN8URX9sNzwWDBR6xQXKzTJNoj7nD5Uukv7a4HSA\nz95VRcoQLn/Z/uyqNkm1IGYrkLRFDQ5i4Z6qZuish3EBfo4iJQLewQ6fEV8fXATi\nlurusOHI2UhAiFVCbDoRQUCvHlW7oHf0T7sr8uhmFc55poqnfkAZDakmslnon290\nNgNZkn9NU+1eyAaV8qVjohGOyCfXyNvuK55/EXDm7mOWG7NLVZSnTMUzSr/LbIHr\ntcssGjECgYEA3ZdW2/zI5MsymfDPKHm3SlxVxJTtCclJNOeGU2Y5rgcBcMfKZ/Zg\nvBlbWUSelj/T36RzHBLuM1nlpZXZ4sg+bOXrS/HMgSeqOxBNibSp3TaAoGygiHIC\n8seClifFlFOTAxTZnhC8EE/aA1OBGM/yBNO821wjUxxUFtzb60jx+E8CgYEA2g0C\naTqIMtNVreE4K2+4Ouyvd1183vnxTwZTTzxOD/+oEA9ZA+qmKucRof2IX3a79+5w\niJ8m5e6luRoWFan/AUYBKpMGsM8bt5ox3s9AoVJvioZHF4dI5kSPCbbdPrtQJeRZ\nAj5aBZWjnGIejt4AtK7XoOvFckabWo4LRvHqJRsCgYEAsQKz4AeOczXethonYa3Z\nPQ2FdgOBVs/0Ks7H/tcqPFpcTDtM9L9bhua6khS+mkdieMRlL4fvwBWP3TZXV1Ge\njF8eFwyQ0Jte4M+lINuw1YU0OvKLSnPI5yd4qXob2uDoDw4YyKuVj3I6NW3/MlLq\ngfCibJitnzaB9cF36/vZTwECgYEAta2zPZQcWSTGtar6zw411TrR9EW7vllImwxt\nK47Wh/P+xurSwzWmoAaJJYyGLOxUL37G2r6ofVo7UKAQmJpcs2XtoNiB8Z2OvYrH\nVJsggYmbEDNTVqJMtjeXaoOnkhYl8HxzQTBMd2y3tpv2VBlbQzCOzzDDAbUcyfWi\nJcl4ytMCgYEAwwRqONavGC0582fHMS2pkAEK6wmuTrnfDK/KYPN8koqWqLElgmNc\nBefCNVLx15nyuMBZN4h3G7MPPYAmW1qiqfxq+48+o6OVjS649aiV26K7YdiZEj5q\n6I1mmMWB2wHcblNNOCXffm/+rDi13/j1ABlS95t56RheP/v09PaSUEM=\n-----END RSA PRIVATE KEY-----")
	oldCert = []byte("-----BEGIN CERTIFICATE-----\nMIIFHzCCAwegAwIBAgIUG0NpL8v2J5PEEeWBltdAfNAzwPwwDQYJKoZIhvcNAQEL\nBQAwFDESMBAGA1UEAwwJbG9jYWxob3N0MB4XDTIxMDgwMzA1NDIzN1oXDTIyMDgw\nMzA1NDIzN1owFDESMBAGA1UEAwwJbG9jYWxob3N0MIICIjANBgkqhkiG9w0BAQEF\nAAOCAg8AMIICCgKCAgEA1V+e++aO0popPMqd937QaGRRlwgB+C6SlnTiQY+gGY+E\nU16ToywgNj4s6fg6VKhhia2urUEPwX91KlKweiJ+PdDJBNKe0oufhmLrs7cO4OZp\nQr9Z6XZeh39zNjYDsWK1Tp6T8zJ4E+nfqffjRiAJ9rszr1waT6ElAf9QIHSrGaZN\nDVaCM95jgN/nVx46exVqDcIjuWAXIFkO6NVBaC+ev76DqNC/raZpkxbUGnFP7PGV\nrVbEILVmw4s2czcv9hVHhtOZWb7eXv0VFMy8FoF8HiLjW+eGwWqI0r2yJ6YPRbsk\nHrW4cviZ7cLV5nOdfMyWfCIGa8Pj2+eOuDFANf2PRkzUf0itIp6kG9CCVviC917b\nBGHKpYofwLe5BXI7+Qqx+M0IuDouiRE6TOrQxZFiPXA+miIWUXd+0g2YKhXRb6V/\njbPm7VPNPqpOqePZ97PySRMQDIjtg4HhpK20hXV090uFX/+KDhW0Mnxd6eDpQilM\nJvUmzakyuUNvNUP3ep7/I+/EZd9bUuNmZUR3bjrOqlyW46RfgtuyODhoiZ5gQYI/\niWrU4IPMftyXM5FRqHKdJFmAD8YrxAt7HmO8rJZ4Bk42HgYX3yQpmKOAFGMuD7kv\nRRwCon8bUjMR7KiIjJkAwtBqmO4OEFlz7zn/jgi15TB0BGWFAtdhgVRyu4waYlsC\nAwEAAaNpMGcwHQYDVR0OBBYEFHIh9FI3Cn8Pu4bDup6pmTmKadRzMB8GA1UdIwQY\nMBaAFHIh9FI3Cn8Pu4bDup6pmTmKadRzMA8GA1UdEwEB/wQFMAMBAf8wFAYDVR0R\nBA0wC4IJbG9jYWxob3N0MA0GCSqGSIb3DQEBCwUAA4ICAQCk7zi5ZtG80NozZnT6\n2b1lkseryKJ3yMbhGE+saexSahbhg9r6He1pyl61MCU0vFhVGJoLDX11nEkF+QNW\nNTFpGvp+rOWix2SP8lo3Lb8gUU5A84lPZUvPYyaq1LGTsMuO+HydqpzLPHX+nUKl\nPdvc9COeJDkTkKBTFUvi0Skd+iaQ43Sfpjz4lvujG2TPQlHHkmKY2DX8QAHg18yJ\nUJ0iNp7tmc1OFqPLQw6K9J7TNsw06Oa2akrgaKatFCEwDcO5JF5iJ18GwIUlpWxv\njcTbDqRKbcF4s3c/1m992TVgZATNHddt8nRIr1bTMR8e9fLRfk/DfsQFpkhCGsDe\nW5Q9XokDNBAp/ZBEE3zW2Zpb3yVC9Js7iYrs4QZo5pR3HR7skgL0HlHxvpTmlLC/\n30kImNMv8onK3TjI42TyrH6qXqvQSiJgodJ7WrvpeDNeu20swm/tanHh4ysMVaUd\ngjG9e/lyoNEcyqstyRMvgnotBAcdp3ZIndX1N+wxWkrVHVWJmPenKDHAPTm7dsqR\nZfUDh+mSo89BpZOXM+uRsbGBf/t6KGM4fOM0apnJ6/p7ym2v4JCjatirXXMeP7YH\nIqZlcUeZrLnJYjP6NFDBRuxYDc2HRNBsTSRdxV9CL9A8+PAKfJxvSakPYEU9t3Oi\nBPBd+1MJVBKJURtEIpZD499bug==\n-----END CERTIFICATE-----\n")
	labCert = []byte("-----BEGIN CERTIFICATE-----\nMIIHUTCCBjmgAwIBAgIRAMaIHCiHVglqTX+rpXNiKvowDQYJKoZIhvcNAQELBQAw\ngZUxCzAJBgNVBAYTAkdCMRswGQYDVQQIExJHcmVhdGVyIE1hbmNoZXN0ZXIxEDAO\nBgNVBAcTB1NhbGZvcmQxGDAWBgNVBAoTD1NlY3RpZ28gTGltaXRlZDE9MDsGA1UE\nAxM0U2VjdGlnbyBSU0EgT3JnYW5pemF0aW9uIFZhbGlkYXRpb24gU2VjdXJlIFNl\ncnZlciBDQTAeFw0yMDAyMTAwMDAwMDBaFw0yMjAyMDkyMzU5NTlaMIHNMQswCQYD\nVQQGEwJWTjEPMA0GA1UEERMGMTAwMDAwMQ8wDQYDVQQIEwZIYSBOb2kxFDASBgNV\nBAcTC05hbSBUdSBMaWVtMSowKAYDVQQJEyFWVFYgQnVpZGluZyxObyA4IFBoYW4g\nSHVuZyBzdHJlZXQxMDAuBgNVBAoTJ0dpYW8gSGFuZyBUaWV0IEtpZW0gSm9pbnQg\nU3RvY2sgQ29tcGFueTEQMA4GA1UECxMHTWFuYWdlcjEWMBQGA1UEAwwNKi5naHRr\nbGFiLmNvbTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALy+Ir0C2W9P\nYJk17iNUHfMoe/6kB9qRM33uhbTz5sdg7TxrUaKcyqtKnmt5ZRRpac0fMrOBM+rZ\nYj5Aj428M0icGRj62YIDqszWyrIMG+A5Zd/ASKsMLPL1+oYJ4aExdst5PJCPMIQr\nKrbvqIJmteBZKBkE7Kt/1sIlj5DCvTesJU4mPLhCC1Hud4Di2VqJiFEqzknaMlLT\nj/A5b0DbcEORuGgsEsi3z+TwwPI+x20Y33swHq0+eK5OmvfKW1iFYyl3Lst35QlZ\nxDUoQ9iQWfHi6p0ONLi+ADxBsz8b0XQktPe2/tOqLnvUMydeCV7X4QkmKQPv0qzm\ns3f15QGem1UCAwEAAaOCA2AwggNcMB8GA1UdIwQYMBaAFBfZ1iUnZ/kxwklD2TA2\nRIxsqU/rMB0GA1UdDgQWBBRhr4zUrbh2NQMbJPc7RWocyDpGjjAOBgNVHQ8BAf8E\nBAMCBaAwDAYDVR0TAQH/BAIwADAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUH\nAwIwSgYDVR0gBEMwQTA1BgwrBgEEAbIxAQIBAwQwJTAjBggrBgEFBQcCARYXaHR0\ncHM6Ly9zZWN0aWdvLmNvbS9DUFMwCAYGZ4EMAQICMFoGA1UdHwRTMFEwT6BNoEuG\nSWh0dHA6Ly9jcmwuc2VjdGlnby5jb20vU2VjdGlnb1JTQU9yZ2FuaXphdGlvblZh\nbGlkYXRpb25TZWN1cmVTZXJ2ZXJDQS5jcmwwgYoGCCsGAQUFBwEBBH4wfDBVBggr\nBgEFBQcwAoZJaHR0cDovL2NydC5zZWN0aWdvLmNvbS9TZWN0aWdvUlNBT3JnYW5p\nemF0aW9uVmFsaWRhdGlvblNlY3VyZVNlcnZlckNBLmNydDAjBggrBgEFBQcwAYYX\naHR0cDovL29jc3Auc2VjdGlnby5jb20wJQYDVR0RBB4wHIINKi5naHRrbGFiLmNv\nbYILZ2h0a2xhYi5jb20wggF/BgorBgEEAdZ5AgQCBIIBbwSCAWsBaQB2AEalVet1\n+pEgMLWiiWn0830RLEF0vv1JuIWr8vxw/m1HAAABcC0/BYYAAAQDAEcwRQIgRiqM\nwP4eXUgIYIN9jN/POHIEVy4tkhtZgJ1msIL+mq0CIQCftF9rxhZIbGmWbqOjFL6s\ntSuVUIdF7MrxE9AVweirSgB3AN+lXqtogk8fbK3uuF9OPlrqzaISpGpejjsSwCBE\nXCpzAAABcC0/BZ8AAAQDAEgwRgIhALYXyUTDWcYZDKrxyWcwNuW6rbZuNyVuVae+\nz3oLZGI/AiEA1i7DYghVdgzlg1ULg7TjDE+kjz+JBGYPL7CdbmmboWwAdgBByMqx\n3yJGShDGoToJQodeTjGLGwPr60vHaPCQYpYG9gAAAXAtPwWJAAAEAwBHMEUCIQCa\n03dNi/eot3Ru5BXsDk6hCB9oyIUi+75AoOg5BYsFrgIgPNIsq+QH4nmPA4BPSxgU\nVpB64eJ1a6xdxjIQN14D0m8wDQYJKoZIhvcNAQELBQADggEBAHncIAC+Vp0ZnrEu\nRQHIxTQKjhN+Lf+uv8WRN/8+dFb4mr9f4s3UJ4ZziQ/TC6vj41b20TgPu7NDuXKz\nlw0aNlrEeXVXmzlDkY3LjQpZ7uRpLDe1RLpFZXpnilmGOvVYYdeWbNKm7mZwU++F\nIF6TYwLwgVVvVadK8hW5df3MRn4kW5iIyNCafFvLMhS2KdgCZqnoDNCq0Jr7nlTG\n8NlFZZvwYhKVQf/6kdI9jAd1yhnQG5E7KKxiLt/dciucP9aMvN9dwHaldv24yCkq\nyVfW5IkKILFGKlhBqK0dvRJ084nANCBdpLCV+8rHL0kyeX+B8Wdu8lm0t4lG/jBN\nYhtHa0I=\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIGGTCCBAGgAwIBAgIQE31TnKp8MamkM3AZaIR6jTANBgkqhkiG9w0BAQwFADCB\niDELMAkGA1UEBhMCVVMxEzARBgNVBAgTCk5ldyBKZXJzZXkxFDASBgNVBAcTC0pl\ncnNleSBDaXR5MR4wHAYDVQQKExVUaGUgVVNFUlRSVVNUIE5ldHdvcmsxLjAsBgNV\nBAMTJVVTRVJUcnVzdCBSU0EgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkwHhcNMTgx\nMTAyMDAwMDAwWhcNMzAxMjMxMjM1OTU5WjCBlTELMAkGA1UEBhMCR0IxGzAZBgNV\nBAgTEkdyZWF0ZXIgTWFuY2hlc3RlcjEQMA4GA1UEBxMHU2FsZm9yZDEYMBYGA1UE\nChMPU2VjdGlnbyBMaW1pdGVkMT0wOwYDVQQDEzRTZWN0aWdvIFJTQSBPcmdhbml6\nYXRpb24gVmFsaWRhdGlvbiBTZWN1cmUgU2VydmVyIENBMIIBIjANBgkqhkiG9w0B\nAQEFAAOCAQ8AMIIBCgKCAQEAnJMCRkVKUkiS/FeN+S3qU76zLNXYqKXsW2kDwB0Q\n9lkz3v4HSKjojHpnSvH1jcM3ZtAykffEnQRgxLVK4oOLp64m1F06XvjRFnG7ir1x\non3IzqJgJLBSoDpFUd54k2xiYPHkVpy3O/c8Vdjf1XoxfDV/ElFw4Sy+BKzL+k/h\nfGVqwECn2XylY4QZ4ffK76q06Fha2ZnjJt+OErK43DOyNtoUHZZYQkBuCyKFHFEi\nrsTIBkVtkuZntxkj5Ng2a4XQf8dS48+wdQHgibSov4o2TqPgbOuEQc6lL0giE5dQ\nYkUeCaXMn2xXcEAG2yDoG9bzk4unMp63RBUJ16/9fAEc2wIDAQABo4IBbjCCAWow\nHwYDVR0jBBgwFoAUU3m/WqorSs9UgOHYm8Cd8rIDZsswHQYDVR0OBBYEFBfZ1iUn\nZ/kxwklD2TA2RIxsqU/rMA4GA1UdDwEB/wQEAwIBhjASBgNVHRMBAf8ECDAGAQH/\nAgEAMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjAbBgNVHSAEFDASMAYG\nBFUdIAAwCAYGZ4EMAQICMFAGA1UdHwRJMEcwRaBDoEGGP2h0dHA6Ly9jcmwudXNl\ncnRydXN0LmNvbS9VU0VSVHJ1c3RSU0FDZXJ0aWZpY2F0aW9uQXV0aG9yaXR5LmNy\nbDB2BggrBgEFBQcBAQRqMGgwPwYIKwYBBQUHMAKGM2h0dHA6Ly9jcnQudXNlcnRy\ndXN0LmNvbS9VU0VSVHJ1c3RSU0FBZGRUcnVzdENBLmNydDAlBggrBgEFBQcwAYYZ\naHR0cDovL29jc3AudXNlcnRydXN0LmNvbTANBgkqhkiG9w0BAQwFAAOCAgEAThNA\nlsnD5m5bwOO69Bfhrgkfyb/LDCUW8nNTs3Yat6tIBtbNAHwgRUNFbBZaGxNh10m6\npAKkrOjOzi3JKnSj3N6uq9BoNviRrzwB93fVC8+Xq+uH5xWo+jBaYXEgscBDxLmP\nbYox6xU2JPti1Qucj+lmveZhUZeTth2HvbC1bP6mESkGYTQxMD0gJ3NR0N6Fg9N3\nOSBGltqnxloWJ4Wyz04PToxcvr44APhL+XJ71PJ616IphdAEutNCLFGIUi7RPSRn\nR+xVzBv0yjTqJsHe3cQhifa6ezIejpZehEU4z4CqN2mLYBd0FUiRnG3wTqN3yhsc\nSPr5z0noX0+FCuKPkBurcEya67emP7SsXaRfz+bYipaQ908mgWB2XQ8kd5GzKjGf\nFlqyXYwcKapInI5v03hAcNt37N3j0VcFcC3mSZiIBYRiBXBWdoY5TtMibx3+bfEO\ns2LEPMvAhblhHrrhFYBZlAyuBbuMf1a+HNJav5fyakywxnB2sJCNwQs2uRHY1ihc\n6k/+JLcYCpsM0MF8XPtpvcyiTcaQvKZN8rG61ppnW5YCUtCC+cQKXA0o4D/I+pWV\nidWkvklsQLI+qGu41SWyxP7x09fn1txDAXYw+zuLXfdKiXyaNb78yvBXAfCNP6CH\nMntHWpdLgtJmwsQt6j8k9Kf5qLnjatkYYaA7jBU=\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIFgTCCBGmgAwIBAgIQOXJEOvkit1HX02wQ3TE1lTANBgkqhkiG9w0BAQwFADB7\nMQswCQYDVQQGEwJHQjEbMBkGA1UECAwSR3JlYXRlciBNYW5jaGVzdGVyMRAwDgYD\nVQQHDAdTYWxmb3JkMRowGAYDVQQKDBFDb21vZG8gQ0EgTGltaXRlZDEhMB8GA1UE\nAwwYQUFBIENlcnRpZmljYXRlIFNlcnZpY2VzMB4XDTE5MDMxMjAwMDAwMFoXDTI4\nMTIzMTIzNTk1OVowgYgxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpOZXcgSmVyc2V5\nMRQwEgYDVQQHEwtKZXJzZXkgQ2l0eTEeMBwGA1UEChMVVGhlIFVTRVJUUlVTVCBO\nZXR3b3JrMS4wLAYDVQQDEyVVU0VSVHJ1c3QgUlNBIENlcnRpZmljYXRpb24gQXV0\naG9yaXR5MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAgBJlFzYOw9sI\ns9CsVw127c0n00ytUINh4qogTQktZAnczomfzD2p7PbPwdzx07HWezcoEStH2jnG\nvDoZtF+mvX2do2NCtnbyqTsrkfjib9DsFiCQCT7i6HTJGLSR1GJk23+jBvGIGGqQ\nIjy8/hPwhxR79uQfjtTkUcYRZ0YIUcuGFFQ/vDP+fmyc/xadGL1RjjWmp2bIcmfb\nIWax1Jt4A8BQOujM8Ny8nkz+rwWWNR9XWrf/zvk9tyy29lTdyOcSOk2uTIq3XJq0\ntyA9yn8iNK5+O2hmAUTnAU5GU5szYPeUvlM3kHND8zLDU+/bqv50TmnHa4xgk97E\nxwzf4TKuzJM7UXiVZ4vuPVb+DNBpDxsP8yUmazNt925H+nND5X4OpWaxKXwyhGNV\nicQNwZNUMBkTrNN9N6frXTpsNVzbQdcS2qlJC9/YgIoJk2KOtWbPJYjNhLixP6Q5\nD9kCnusSTJV882sFqV4Wg8y4Z+LoE53MW4LTTLPtW//e5XOsIzstAL81VXQJSdhJ\nWBp/kjbmUZIO8yZ9HE0XvMnsQybQv0FfQKlERPSZ51eHnlAfV1SoPv10Yy+xUGUJ\n5lhCLkMaTLTwJUdZ+gQek9QmRkpQgbLevni3/GcV4clXhB4PY9bpYrrWX1Uu6lzG\nKAgEJTm4Diup8kyXHAc/DVL17e8vgg8CAwEAAaOB8jCB7zAfBgNVHSMEGDAWgBSg\nEQojPpbxB+zirynvgqV/0DCktDAdBgNVHQ4EFgQUU3m/WqorSs9UgOHYm8Cd8rID\nZsswDgYDVR0PAQH/BAQDAgGGMA8GA1UdEwEB/wQFMAMBAf8wEQYDVR0gBAowCDAG\nBgRVHSAAMEMGA1UdHwQ8MDowOKA2oDSGMmh0dHA6Ly9jcmwuY29tb2RvY2EuY29t\nL0FBQUNlcnRpZmljYXRlU2VydmljZXMuY3JsMDQGCCsGAQUFBwEBBCgwJjAkBggr\nBgEFBQcwAYYYaHR0cDovL29jc3AuY29tb2RvY2EuY29tMA0GCSqGSIb3DQEBDAUA\nA4IBAQAYh1HcdCE9nIrgJ7cz0C7M7PDmy14R3iJvm3WOnnL+5Nb+qh+cli3vA0p+\nrvSNb3I8QzvAP+u431yqqcau8vzY7qN7Q/aGNnwU4M309z/+3ri0ivCRlv79Q2R+\n/czSAaF9ffgZGclCKxO/WIu6pKJmBHaIkU4MiRTOok3JMrO66BQavHHxW/BBC5gA\nCiIDEOUMsfnNkjcZ7Tvx5Dq2+UUTJnWvu6rvP3t3O9LEApE9GQDTF1w52z97GA1F\nzZOFli9d31kWTz9RvdVFGD/tSo7oBmF0Ixa1DVBzJ0RHfxBdiSprhTEUxOipakyA\nvGp4z7h/jnZymQyd/teRCBaho1+V\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIEMjCCAxqgAwIBAgIBATANBgkqhkiG9w0BAQUFADB7MQswCQYDVQQGEwJHQjEb\nMBkGA1UECAwSR3JlYXRlciBNYW5jaGVzdGVyMRAwDgYDVQQHDAdTYWxmb3JkMRow\nGAYDVQQKDBFDb21vZG8gQ0EgTGltaXRlZDEhMB8GA1UEAwwYQUFBIENlcnRpZmlj\nYXRlIFNlcnZpY2VzMB4XDTA0MDEwMTAwMDAwMFoXDTI4MTIzMTIzNTk1OVowezEL\nMAkGA1UEBhMCR0IxGzAZBgNVBAgMEkdyZWF0ZXIgTWFuY2hlc3RlcjEQMA4GA1UE\nBwwHU2FsZm9yZDEaMBgGA1UECgwRQ29tb2RvIENBIExpbWl0ZWQxITAfBgNVBAMM\nGEFBQSBDZXJ0aWZpY2F0ZSBTZXJ2aWNlczCCASIwDQYJKoZIhvcNAQEBBQADggEP\nADCCAQoCggEBAL5AnfRu4ep2hxxNRUSOvkbIgwadwSr+GB+O5AL686tdUIoWMQua\nBtDFcCLNSS1UY8y2bmhGC1Pqy0wkwLxyTurxFa70VJoSCsN6sjNg4tqJVfMiWPPe\n3M/vg4aijJRPn2jymJBGhCfHdr/jzDUsi14HZGWCwEiwqJH5YZ92IFCokcdmtet4\nYgNW8IoaE+oxox6gmf049vYnMlhvB/VruPsUK6+3qszWY19zjNoFmag4qMsXeDZR\nrOme9Hg6jc8P2ULimAyrL58OAd7vn5lJ8S3frHRNG5i1R8XlKdH5kBjHYpy+g8cm\nez6KJcfA3Z3mNWgQIJ2P2N7Sw4ScDV7oL8kCAwEAAaOBwDCBvTAdBgNVHQ4EFgQU\noBEKIz6W8Qfs4q8p74Klf9AwpLQwDgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQF\nMAMBAf8wewYDVR0fBHQwcjA4oDagNIYyaHR0cDovL2NybC5jb21vZG9jYS5jb20v\nQUFBQ2VydGlmaWNhdGVTZXJ2aWNlcy5jcmwwNqA0oDKGMGh0dHA6Ly9jcmwuY29t\nb2RvLm5ldC9BQUFDZXJ0aWZpY2F0ZVNlcnZpY2VzLmNybDANBgkqhkiG9w0BAQUF\nAAOCAQEACFb8AvCb6P+k+tZ7xkSAzk/ExfYAWMymtrwUSWgEdujm7l3sAg9g1o1Q\nGE8mTgHj5rCl7r+8dFRBv/38ErjHT1r0iWAFf2C3BUrz9vHCv8S5dIa2LX1rzNLz\nRt0vxuBqw8M0Ayx9lt1awg6nCpnBBYurDC/zXDrPbDdVCYfeU0BsWO/8tqtlbgT2\nG9w84FoVxp7Z8VlIMCFlA2zs6SFz7JsDoeA3raAVGI/6ugLOpyypEBMs1OUIJqsi\nl2D4kF501KKaU73yqWjgom7C12yxow+ev+to51byrvLjKzg6CYG1a4XXvi3tPxq3\nsmPi9WIsgtRqAEFQ8TmDn5XpNpaYbg==\n-----END CERTIFICATE-----")
	certCalocal = []byte("-----BEGIN CERTIFICATE-----\nMIIFHzCCAwegAwIBAgIUG0NpL8v2J5PEEeWBltdAfNAzwPwwDQYJKoZIhvcNAQEL\nBQAwFDESMBAGA1UEAwwJbG9jYWxob3N0MB4XDTIxMDgwMzA1NDIzN1oXDTIyMDgw\nMzA1NDIzN1owFDESMBAGA1UEAwwJbG9jYWxob3N0MIICIjANBgkqhkiG9w0BAQEF\nAAOCAg8AMIICCgKCAgEA1V+e++aO0popPMqd937QaGRRlwgB+C6SlnTiQY+gGY+E\nU16ToywgNj4s6fg6VKhhia2urUEPwX91KlKweiJ+PdDJBNKe0oufhmLrs7cO4OZp\nQr9Z6XZeh39zNjYDsWK1Tp6T8zJ4E+nfqffjRiAJ9rszr1waT6ElAf9QIHSrGaZN\nDVaCM95jgN/nVx46exVqDcIjuWAXIFkO6NVBaC+ev76DqNC/raZpkxbUGnFP7PGV\nrVbEILVmw4s2czcv9hVHhtOZWb7eXv0VFMy8FoF8HiLjW+eGwWqI0r2yJ6YPRbsk\nHrW4cviZ7cLV5nOdfMyWfCIGa8Pj2+eOuDFANf2PRkzUf0itIp6kG9CCVviC917b\nBGHKpYofwLe5BXI7+Qqx+M0IuDouiRE6TOrQxZFiPXA+miIWUXd+0g2YKhXRb6V/\njbPm7VPNPqpOqePZ97PySRMQDIjtg4HhpK20hXV090uFX/+KDhW0Mnxd6eDpQilM\nJvUmzakyuUNvNUP3ep7/I+/EZd9bUuNmZUR3bjrOqlyW46RfgtuyODhoiZ5gQYI/\niWrU4IPMftyXM5FRqHKdJFmAD8YrxAt7HmO8rJZ4Bk42HgYX3yQpmKOAFGMuD7kv\nRRwCon8bUjMR7KiIjJkAwtBqmO4OEFlz7zn/jgi15TB0BGWFAtdhgVRyu4waYlsC\nAwEAAaNpMGcwHQYDVR0OBBYEFHIh9FI3Cn8Pu4bDup6pmTmKadRzMB8GA1UdIwQY\nMBaAFHIh9FI3Cn8Pu4bDup6pmTmKadRzMA8GA1UdEwEB/wQFMAMBAf8wFAYDVR0R\nBA0wC4IJbG9jYWxob3N0MA0GCSqGSIb3DQEBCwUAA4ICAQCk7zi5ZtG80NozZnT6\n2b1lkseryKJ3yMbhGE+saexSahbhg9r6He1pyl61MCU0vFhVGJoLDX11nEkF+QNW\nNTFpGvp+rOWix2SP8lo3Lb8gUU5A84lPZUvPYyaq1LGTsMuO+HydqpzLPHX+nUKl\nPdvc9COeJDkTkKBTFUvi0Skd+iaQ43Sfpjz4lvujG2TPQlHHkmKY2DX8QAHg18yJ\nUJ0iNp7tmc1OFqPLQw6K9J7TNsw06Oa2akrgaKatFCEwDcO5JF5iJ18GwIUlpWxv\njcTbDqRKbcF4s3c/1m992TVgZATNHddt8nRIr1bTMR8e9fLRfk/DfsQFpkhCGsDe\nW5Q9XokDNBAp/ZBEE3zW2Zpb3yVC9Js7iYrs4QZo5pR3HR7skgL0HlHxvpTmlLC/\n30kImNMv8onK3TjI42TyrH6qXqvQSiJgodJ7WrvpeDNeu20swm/tanHh4ysMVaUd\ngjG9e/lyoNEcyqstyRMvgnotBAcdp3ZIndX1N+wxWkrVHVWJmPenKDHAPTm7dsqR\nZfUDh+mSo89BpZOXM+uRsbGBf/t6KGM4fOM0apnJ6/p7ym2v4JCjatirXXMeP7YH\nIqZlcUeZrLnJYjP6NFDBRuxYDc2HRNBsTSRdxV9CL9A8+PAKfJxvSakPYEU9t3Oi\nBPBd+1MJVBKJURtEIpZD499bug==\n-----END CERTIFICATE-----\n")
)

func createDSRequest (maxSize int64) (*igrpcproto.SQLQueryRequest, error){
	jsFile, err := os.Open("dsReq.json")
	if err != nil {
		return nil, err
	}

	req := &igrpcproto.SQLQueryRequest{}
	err = json.NewDecoder(jsFile).Decode(req)
	if err != nil {
		return nil, err
	}

	limit := 1 + rand.Int63n(10)
	page := rand.Int63n(maxSize/limit)
	req.Paginate.Limit = limit
	req.Paginate.Page = page
	//b, err := json.Marshal(1)
	//if err != nil {
	//	log.Println("can't get json marshal")
	//}
	//req.Conjunctions[0].Conditions[0].Value = b
	return req, nil
}

func createESRequest (maxSize int64) (*igrpcproto.ESQuery, error){
	limit := 1 + rand.Int63n(100)
	page := rand.Int63n(maxSize/limit)
	body, err := json.Marshal(map[string]interface{}{
		"from": page,
		"size": limit,
	})
	if err != nil {
		log.Println("can't create request body")
		return nil, err
	}
	esRequest := &igrpcproto.ESQuery{
		ConnectionName: "reportr",
		IndexName:      "packages",
		Body:           body,
	}
	return esRequest, nil
}

func LoadTLSCredentials() (credentials.TransportCredentials, error) {
	// Load cert and key for client
	//clientCert, err := tls.LoadX509KeyPair("/home/tungnguyenthanh/Downloads/client-cert1.pem", "/home/tungnguyenthanh/Downloads/client-key1.pem")
	//if err != nil {
	//	return nil, err
	//}

	// Load certificate of the CA who signed server's certificate
	certPool := x509.NewCertPool()
	if !certPool.AppendCertsFromPEM(certCalocal) {
		return nil, fmt.Errorf("/home/tungnguyenthanh/Downloads/ghtk-cert.pem")
	}

	// Create the credentials and return it
	config := &tls.Config{
		//Certificates: []tls.Certificate{clientCert},
		RootCAs:      certPool,
	}

	return credentials.NewTLS(config), nil
}

func LoadTLSCredentialsOld() (credentials.TransportCredentials, error) {
	certPool := x509.NewCertPool()
	if !certPool.AppendCertsFromPEM(labCert) {
		return nil, fmt.Errorf("/home/tungnguyenthanh/Downloads/ghtk-cert.pem")
	}
	config := &tls.Config{
		RootCAs:      certPool,
	}
	return credentials.NewTLS(config), nil
}
